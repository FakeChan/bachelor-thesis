clc;
varlist={'q','u','v','t','mu'};
l=length(varlist);
nml={'d02','12tpoint_d02_0200','4tpoint_d02_0200','0200','0230','0300','0200_01_03_24t','fg','NR'};
rgbTriplet = [0.57, 0.69, 0.30;...
    0.89, 0.88, 0.57;...
    0.76, 0.49, 0.58;...
    0.47, 0.76, 0.81;...
    0.21, 0.21, 0.35;...
    0.28, 0.57, 0.54;...
    0.07, 0.35, 0.40;...
    0.41, 0.20, 0.42;...
    0.60, 0.24, 0.18;...
    0.76, 0.84, 0.65;...
    0.77, 0.18, 0.78;...
    0.21, 0.33, 0.64;...
    0.88, 0.17, 0.56;...
    0.20, 0.69, 0.28;...
    0.26, 0.15, 0.47;...
    0.83, 0.27, 0.44;...
    0.87, 0.85, 0.42;...
    0.85, 0.51, 0.87;...
    0.99, 0.62, 0.76;...
    0.52, 0.43, 0.87;...
    0.00, 0.68, 0.92;...
    0.26, 0.45, 0.77;...
    0.98, 0.75, 0.00;...
    0.72, 0.81, 0.76;...
    0.77, 0.18, 0.78;...
    0.28, 0.39, 0.44;...
    0.22, 0.26, 0.24;...
    0.64, 0.52, 0.64;...
    0.87, 0.73, 0.78;...
    0.94, 0.89, 0.85;...
    0.85, 0.84, 0.86];
rms=zeros(length(nml)-1,l);
square=zeros(length(nml),l);
for k=1:l
    name=varlist{k};
    figure(k)
    mode=100;
    ek=zeros(mode,length(nml));
    e_main=zeros(length(nml),1);
    set(gcf, 'unit', 'centimeters', 'position', [13 0 25 18]);
    set(gca, 'unit', 'centimeters', 'position', [3 3 20 13]);
    nml={'d02','12tpoint_d02_0200','4tpoint_d02_0200','0200','0230','0300','0200_01_03_24t','fg','NR'};
    for i=1:length(nml)
        if i==length(nml)
            nml={'d02','12tpoint_d02_0200','4tpoint_d02_0200','0200','0230','0300','0200_01_03_24t','fg','NR'};
            filename=strcat(nml{i},'_',name,'_test.txt');
            [ek(:,i),e_main(i)]=var_ek(filename);
            plot(0:100,log10([e_main(i);ek(:,i)]),'LineWidth',3,'Color',[249, 199, 79]/255)
            hold on
        else
            nml={'d02','12tpoint_d02_0200','4tpoint_d02_0200','0200','0230','0300','0200_01_03_24t','fg','NR'};
            filename=strcat(nml{i},'_',name,'_test.txt');
            [ek(:,i),e_main(i)]=var_ek(filename);
            plot(0:100,log10([e_main(i);ek(:,i)]),'LineWidth',1.5,'color',rgbTriplet(i*4-3,:))
            hold on
        end
    end
    nml={'Obs1.5\_Sep0min\_T1','Obs1.5\_Sep10min\_T12','Obs1.5\_Sep30min\_T4','Obs7.5\_Sep0min\_T1','Obs7.5\_Sep30min\_T3','Obs7.5\_Sep30min\_T5','Obs7.5\_Sep5min\_T24','fg','NR'};
    title(name)
    xlabel('num of waves')
    ylabel('log E')
    legend(nml,'FontSize',18)
    saveas(gcf,strcat('ek_',name,'.png'))
    
    %====================================================
    %rms
    
    for i=1:length(nml)-1
        rms(i,k)=sum((ek(:,i)-ek(:,end)).^2);
    end
    %====================================================
    %面积积分
    
    x=1:1:101;
    for i=1:length(nml)
        square(i,k)=trapz(x,[(e_main(i)-e_main(end)).^2;(ek(:,i)-ek(:,end)).^2]);
    end
    
end


